<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hello</title>
    <link rel="stylesheet" type="text/css" href="css/m.css">
    <link rel="stylesheet" type="text/css" href="css/audio.css">
</head>
<body>
    <img class="bg" src="pic/bg.jpg" alt="">
    <!-- é¡¶ç«¯ç›®å½• -->
    <div>
        <ul class="topmenu">
            <li><img src="pic/stream-pig.gif" width="40" height="40" alt=""></li>
            <li><a href="src/home.html">ä¸»é¡µ</a></li>
            <li><a href="src/articles.html">è‰ºæœ¯é‰´èµ</a></li>
            <li><a href="src/minecraft.html">æ¨¡ç»„åˆ¶ä½œ</a></li>
            <li><a href="#blog" class="undo" title="æ²¡åšå¥½">éšå¦‚ğŸ–Š</a></li>
            <li><a href="#donation" class="undo" title="æ²¡åšå¥½">æŠ•å–‚</a></li>
            <li><div class="breathe" id="clock"></div></li>
        </ul>
    </div>

    <!-- è¿™ä¸ªæˆ‘å–œæ¬¢ -->
    <div id="suki">
        <img alt="" title="æˆ‘æœ¬äºº" src="pic/lemon.jpg" width="200" height="300" id="lm"><br>
        <p>
            <b>æ¬¢è¿æ¥åˆ°æˆ‘çš„ç½‘ç«™ ç‚¹å‡»ä¸Šæ–¹å¯¼èˆªæ äº†è§£ç½‘ç«™</b><br>
            <a href="src/update.html">ç‚¹å‡»æŸ¥çœ‹æ›´æ–°æ—¥å¿—</a>
        </p>
    </div>
    
    <!-- éŸ³é¢‘åŒºå—  -->
    <div id="audiom" title="music">
        <div id="playarea">
            <audio id="audio_player"></audio>
            <div id="trackinfo">è¯·é€‰æ‹©æ­Œæ›²</div>
            <div id="audiobt">
                <button type="button" onclick="pgdown()">ğŸ‘ˆ</button>
                <button type="button" onclick="pause()" id="pausebt">â–¶</button>
                <button type="button" onclick="pgup()">ğŸ‘‰</button>
            </div>
        </div>
        <div id="trackinfo"></div>
        <div id="progress">
            <input placeholder="0" type="range" id="pgslider" min="0" max="100" value="0" oninput="seekaudio(this.value)">
            <span id="pgtxt">0: 00 / 0: 00</span>
        </div>
    </div>

    <!-- åº•éƒ¨å°å›¾æ ‡ -->
    <div id="bottomm">
        <ul class="bottom-bar">
            <li><a>å…³æ³¨ä¸»æ’­å–µ</a></li>
            <li><img src="pic/trakov-logo.webp" alt="" width="60" height="25"></li>
            <li><img src="pic/Dynamix_logo.webp" alt="" width="25" height="25"></li>
        </ul>
    </div>
    <!-- ç¥ç§˜å°æŒ‰é’® -->
    <a class="bt" href="src/admin.html">login</a>
</body>
<script src="components/sc.js"></script>
<script>
    let statu = false;
    let list = [
        {artist: "Feryquitous", trackname: "æ„šã‹è€…ã®è³¢äººè«–", src: "audio/Feryquitous - æ„šã‹è€…ã®è³¢äººè«–.mp3"},
        {artist: "Dachs", trackname: "Holy Night,Silent Night", src: "audio/Dachs - Holy Night, Silent Night.mp3"},
        {artist: "Dachs", trackname: "Mother Earth (Original Mix)", src: "audio/Mother Earth (Original Mix) - Dachs.mp3"},
        {artist: "DJ TOTTO", trackname: "ç«¥è©±å›å»Š", src: "audio/DJ TOTTO - ç«¥è©±å›å»Š.mp3"},
        {artist: "polysha", trackname: "Where The Spirits Go on", src: "audio/polysha - Where The Spirits Go on.mp3"}
    ];
    let pos = 0;
    const len = list.length - 1;

    const audio = document.getElementById("audio_player");
    const pgslider = document.getElementById("pgslider");
    const pgtxt = document.getElementById("pgtxt");
    const pausebt = document.getElementById("pausebt");
    const trackinfo = document.getElementById("trackinfo");

    const GetCurrentTrack = () => {return list[pos].src;}
    const Currentname = () => {return list[pos].artist+ " - "+ list[pos].trackname;}

    const formatTime = (seconds) => {
        if (isNaN(seconds)) return "0:00";
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    function loadTrack(index) {
        if (index < 0 || index >= list.length) return;
        pos = index;
        audio.src = list[pos].src;
        trackinfo.textContent = Currentname();
        pgslider.value = 0;
        pgtxt.textContent = "0:00 / 0:00";
        if (statu) {
            audio.play().catch(e => console.log("è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢:", e));
        }
    }

    const pgdn = () => {
        audio.pause();statu = false;
        if(pos == 0)pos = len;
        else pos--;
        loadTrack(pos);
    }

    const pgup = () => {
        audio.pause();statu = false;
        if(pos == len)pos = 0;
        else pos++;
        loadTrack(pos);
    }

    const pause = () => {
        if(statu){
            pausebt.innerText = "â–¶";
            audio.pause();
        }else{
            if(!audio.src){
                loadTrack(pos);
            }
            audio.play();
            pausebt.innerText = "â¸"; 
        }
        statu = !statu;
    }

    const seekaudio = (percent) => {
        if(!audio.duration)return;
        const time = audio.duration * (percent / 100);
        audio.currentTime = time;
    }

    const setvolume = (percent) => {audio.volume = percent;}

    audio.ontimeupdate = () => {
        if(!audio.duration)return;

        const percent1 = audio.currentTime / audio.duration * 100;
        pgslider.value = percent1 || 0;

        const current = formatTime(audio.currentTime);
        const total = formatTime(audio.duration || 0);
        pgtxt.textContent = `${current} / ${total}`;
    }

    audio.onended = () => {pgup();}
    audio.onloadedmetadata = () => {pgtxt.textContent = `0:00 / ${formatTime(audio.duration)}`;}
    
    loadTrack(pos);
</script>
</html>
